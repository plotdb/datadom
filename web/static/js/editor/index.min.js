function import$(e,n){var t={}.hasOwnProperty;for(var r in n)t.call(n,r)&&(e[r]=n[r]);return e}!function(){var e,n,t,r,a,i;e={},n=new sharedbWrapper,t=function(n,t){var r;return json0.type.apply(e.data,n),r=ld$.find("[ld=remote]",0),r.innerHTML="",datadom.deserialize(e.data,i).then(function(e){var n,t,a;return n=e.node,e.promise,r.appendChild(n),t="//- pug\n"+html2pug(r.innerHTML,{fragment:!0}),a=ld$.find("[ld=pug]",0),a.innerText=t})},r=function(e){var n;return null==e&&(e={}),this.data={data:(n=e.data||{}).data,dev:n.dev},this.data.dev=!0,this},r.prototype=import$(Object.create(Object.prototype),{serialize:function(){var e;return{data:(e=this.data).data,dev:e.dev}}}),window.pt=a={name:"plugin-test",version:"0.0.1",map:{set:function(e,n){return console.log(e),a.map.wm||(a.map.wm=new WeakMap),a.map.wm.set(e,n)},get:function(e){return a.map.wm||(a.map.wm=new WeakMap),a.map.wm.get(e)}},serialize:function(e){var n,t,r,i;return n=e.data,t=e.node,r=e.plugins,e.window,console.log("serialize ",t),i=a.map.get(t),console.log(i),i&&import$(n,i.serialize()),Promise.all(Array.from(t.childNodes).map(function(e,n){return datadom.serialize(e,r)})).then(function(e){return n.child=n.child.concat(e.map(function(e){return e.data})),Promise.all(e.map(function(e){return e.promise}))})},deserialize:function(e){var n,t;return n=e.data,t=e.node,e.plugs,e.plugins,e.window,console.log("deserialize",t),a.map.set(t,new r({data:n})),console.log("reget",a.map.get(t)),t}},i=[a],new ldView({root:document.body,action:{click:{"load-ce":function(){return fs.writeFileSync("blank",'//- pug\ndiv(dd-plugin="plugin-test@0.0.1") hi'),e.ed.setFiles(fs),e.ed.open("blank"),e.ed.render()}}}}),n.get({id:"sample",watch:t,create:function(){return{}}}).then(function(n){return e.doc=n,e.data=JSON.parse(JSON.stringify(n.data)),getfa("sample").then(function(t){var r,a;return e.fs=t,t.writeFileSync("blank","//- pug\nh1 hello world!"),r=function(e){var t;return t=document.createElement("div"),t.innerHTML=e,datadom.serialize(t,i).then(function(e){var n;return n=e.data,e.promise.then(function(){return n})}).then(function(e){var t,r,a;return t=ld$.find("[ld=json]",0),t.innerText=JSON.stringify(e,null,2),r=ld$.find("[ld=dom]",0),datadom.deserialize(e,i).then(function(e){var n,t;return n=e.node,t=e.promise,r.innerHTML="",r.appendChild(n),t.then(function(){return datadom.serialize(n,i)})}).then(function(e){var n;return n=e.data,e.promise.then(function(){return console.log(n)})}),a=json0.diff(n.data,e),n.submitOp(a)})},e.ed=a=new Editor({node:{edit:"[ld=editor]",view:"[ld=viewer]"},editlet:{},renderer:function(e){var n,t,a,i,o;if(n=e.fs){t={html:n.readFileSync("blank").toString()};for(a in t)i=t[a],(o=transpiler.detect(i)).mod&&o.mod.transform&&(t[a]=o.mod.transform(i)),r(t.html);return t}}}),a.setFiles(t),a.open("blank")})})}();